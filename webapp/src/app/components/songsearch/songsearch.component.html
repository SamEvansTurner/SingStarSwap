<mat-drawer-container class="drawer-container" *ngIf="vm$ | async as vm">
  <mat-drawer #settingsDrawer mode="over" position="start">
    <app-song-filters
      [sortBy]="vm.state.sortBy"
      [showAvailableOnly]="vm.state.showAvailableOnly"
      (sortChange)="onSortChange($event)"
      (filterChange)="onFilterChange($event)">
    </app-song-filters>
    <app-server-settings></app-server-settings>
  </mat-drawer>

  <mat-drawer-content class="main-content">
    <div class="content-container">
      <app-letter-navigation
        class="letter-nav-panel"
        [letters]="vm.state.letterIndex"
        [showSettingsButton]="true"
        (letterClick)="onLetterClick($event)"
        (settingsClick)="onSettingsToggle(settingsDrawer)">
      </app-letter-navigation>

      <div class="songs-container">
        <!-- Loading State -->
        <div *ngIf="vm.showLoading" class="loading-container">
          <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>Loading songs...</p>
          </div>
        </div>

        <!-- Error State -->
        <div *ngIf="vm.showError" class="error-container">
          <div class="error-content">
            <h3>Oops! Something went wrong</h3>
            <p>{{ vm.state.error?.errorMessage }}</p>
            <button 
              mat-raised-button 
              color="primary" 
              (click)="processData()">
              Try Again
            </button>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="vm.isEmpty" class="empty-container">
          <div class="empty-content">
            <h3>No songs found</h3>
            <p>Try adjusting your filters or check your data connection.</p>
          </div>
        </div>

        <!-- Content -->
        <div *ngIf="vm.showContent" class="songs-list">
          <div class="songs-stats" *ngIf="vm.state.totalSongs > 0">
            <span>
              Showing {{ vm.state.songs.length }} of {{ vm.state.totalSongs }} songs
              <span *ngIf="vm.state.showAvailableOnly">
                ({{ vm.state.availableSongs }} available)
              </span>
            </span>
          </div>

          <div class="groups-container">
            <app-song-group
              *ngFor="let group of vm.state.groupedSongs; trackBy: trackByGroup"
              [group]="group"
              [sortBy]="vm.state.sortBy"
              (songSelect)="onSongSelect($event)">
            </app-song-group>
          </div>
        </div>
      </div>
    </div>
  </mat-drawer-content>
</mat-drawer-container>
